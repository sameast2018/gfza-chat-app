<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GFZA Chat - Ghana Free Zones Authority</title>
    <meta name="description" content="Official Chat Application for Ghana Free Zones Authority">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1e40af">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="GFZA Chat">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        .chat-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .message-bubble {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .typing-indicator {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div id="app" class="chat-container">
        <!-- Loading Screen -->
        <div id="loading" class="flex items-center justify-center min-h-screen">
            <div class="text-center">
                <div class="w-20 h-20 mx-auto mb-4 bg-white rounded-full flex items-center justify-center shadow-lg">
                    <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center">
                        <span class="text-white font-bold text-lg">GFZA</span>
                    </div>
                </div>
                <h1 class="text-2xl font-bold text-white mb-2">GFZA Chat</h1>
                <p class="text-white/80">Ghana Free Zones Authority</p>
                <div class="mt-4">
                    <div class="inline-block w-8 h-8 border-4 border-white/30 border-t-white rounded-full animate-spin"></div>
                </div>
            </div>
        </div>

        <!-- Auth Screen -->
        <div id="auth" class="hidden min-h-screen flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 bg-blue-600 rounded-full flex items-center justify-center">
                        <span class="text-white font-bold text-xl">GFZA</span>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">Welcome to GFZA Chat</h2>
                    <p class="text-gray-600 mt-2">Ghana Free Zones Authority</p>
                </div>

                <form id="authForm" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                        <input type="text" id="fullName" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                               placeholder="Enter your full name">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" id="email" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                               placeholder="your.email@gfza.gov.gh">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Department</label>
                        <select id="department" required 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Select your department</option>
                            <option value="administration">Administration</option>
                            <option value="finance">Finance</option>
                            <option value="operations">Operations</option>
                            <option value="legal">Legal</option>
                            <option value="marketing">Marketing</option>
                            <option value="hr">Human Resources</option>
                            <option value="it">Information Technology</option>
                            <option value="security">Security</option>
                        </select>
                    </div>

                    <button type="submit" 
                            class="w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                        Enter GFZA Chat
                    </button>
                </form>
            </div>
        </div>

        <!-- Chat Screen -->
        <div id="chat" class="hidden min-h-screen flex flex-col">
            <!-- Header -->
            <div class="bg-white/10 backdrop-blur-sm border-b border-white/20 p-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                            <span class="text-blue-600 font-bold">GFZA</span>
                        </div>
                        <div>
                            <h1 class="text-white font-semibold">GFZA Chat</h1>
                            <p class="text-white/80 text-sm" id="userInfo">Welcome</p>
                        </div>
                    </div>
                    <button id="logoutBtn" class="text-white/80 hover:text-white transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Messages -->
            <div id="messages" class="flex-1 p-4 space-y-4 overflow-y-auto">
                <div class="text-center">
                    <div class="inline-block bg-white/20 backdrop-blur-sm rounded-full px-4 py-2">
                        <p class="text-white/80 text-sm">Welcome to GFZA Chat! Start a conversation.</p>
                    </div>
                </div>
            </div>

            <!-- Input -->
            <div class="p-4 bg-white/10 backdrop-blur-sm border-t border-white/20">
                <div class="flex space-x-3">
                    <input type="text" id="messageInput" 
                           class="flex-1 px-4 py-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white placeholder-white/60 focus:ring-2 focus:ring-white/50 focus:border-transparent"
                           placeholder="Type your message...">
                    <button id="sendBtn" 
                            class="bg-white text-blue-600 px-6 py-3 rounded-lg hover:bg-white/90 transition-colors font-medium">
                        Send
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // App State
        let currentUser = null;
        let messages = [];

        // DOM Elements
        const loading = document.getElementById('loading');
        const auth = document.getElementById('auth');
        const chat = document.getElementById('chat');
        const authForm = document.getElementById('authForm');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const messagesContainer = document.getElementById('messages');
        const userInfo = document.getElementById('userInfo');
        const logoutBtn = document.getElementById('logoutBtn');

        // Initialize App
        setTimeout(() => {
            loading.classList.add('hidden');
            auth.classList.remove('hidden');
        }, 2000);

        // Auth Form Handler
        authForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const fullName = document.getElementById('fullName').value;
            const email = document.getElementById('email').value;
            const department = document.getElementById('department').value;

            currentUser = { fullName, email, department };
            userInfo.textContent = `${fullName} - ${department.charAt(0).toUpperCase() + department.slice(1)}`;
            
            auth.classList.add('hidden');
            chat.classList.remove('hidden');
            
            // Welcome message
            addMessage('system', `Welcome ${fullName}! You're now connected to GFZA Chat.`);
        });

        // Send Message
        function sendMessage() {
            const text = messageInput.value.trim();
            if (!text) return;

            addMessage('user', text);
            messageInput.value = '';

            // Simulate response
            setTimeout(() => {
                const responses = [
                    "Thank you for your message. A GFZA representative will respond shortly.",
                    "Your inquiry has been received and will be processed by the relevant department.",
                    "We appreciate your communication. How else can GFZA assist you today?",
                    "Your message is important to us. We'll get back to you as soon as possible."
                ];
                const response = responses[Math.floor(Math.random() * responses.length)];
                addMessage('system', response);
            }, 1000);
        }

        // Add Message to Chat
        function addMessage(type, text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-bubble flex ${type === 'user' ? 'justify-end' : 'justify-start'}`;
            
            const bubble = document.createElement('div');
            bubble.className = `max-w-xs lg:max-w-md px-4 py-3 rounded-2xl ${
                type === 'user' 
                    ? 'bg-white text-gray-800 rounded-br-sm' 
                    : 'bg-white/20 backdrop-blur-sm text-white rounded-bl-sm'
            }`;
            
            if (type === 'system') {
                bubble.innerHTML = `<div class="flex items-start space-x-2">
                    <div class="w-6 h-6 bg-white/30 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                        <span class="text-xs font-bold">G</span>
                    </div>
                    <div class="text-sm">${text}</div>
                </div>`;
            } else {
                bubble.innerHTML = `<div class="text-sm">${text}</div>`;
            }
            
            messageDiv.appendChild(bubble);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Event Listeners
        sendBtn.addEventListener('click', sendMessage);
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });

        logoutBtn.addEventListener('click', () => {
            currentUser = null;
            messages = [];
            messagesContainer.innerHTML = `
                <div class="text-center">
                    <div class="inline-block bg-white/20 backdrop-blur-sm rounded-full px-4 py-2">
                        <p class="text-white/80 text-sm">Welcome to GFZA Chat! Start a conversation.</p>
                    </div>
                </div>
            `;
            chat.classList.add('hidden');
            auth.classList.remove('hidden');
            authForm.reset();
        });

        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button after 5 seconds
            setTimeout(() => {
                if (deferredPrompt) {
                    const installDiv = document.createElement('div');
                    installDiv.className = 'fixed bottom-4 right-4 bg-white rounded-lg shadow-lg p-4 max-w-sm z-50';
                    installDiv.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center">
                                <span class="text-white font-bold text-sm">GFZA</span>
                            </div>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-gray-800">Install GFZA Chat</p>
                                <p class="text-xs text-gray-600">Add to your home screen</p>
                            </div>
                            <button id="installBtn" class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">Install</button>
                            <button id="dismissBtn" class="text-gray-400 hover:text-gray-600">Ã—</button>
                        </div>
                    `;
                    document.body.appendChild(installDiv);
                    
                    document.getElementById('installBtn').addEventListener('click', () => {
                        deferredPrompt.prompt();
                        deferredPrompt.userChoice.then(() => {
                            deferredPrompt = null;
                            installDiv.remove();
                        });
                    });
                    
                    document.getElementById('dismissBtn').addEventListener('click', () => {
                        installDiv.remove();
                    });
                }
            }, 5000);
        });
    </script>
</body>
</html>
